# Lab6

__林文浩 PB21050974__

#### P1017 素性测试

直接用经典的Miller-Rabin测试，先将待测试数字$n$分解为 $n=2^s\times d$ 的形式，然后随机取一个整数$2\leq a\leq n-2$，计算$x=a^dmod(n)$，如果$x=1$，则$n$不是素数，如果$x=n-1$，则 $n$ 可能是素数，退出循环，如果s次内没有找到满足条件的 $x$，则 $n$ 不是素数。这个算法不是一定正确的，有一定概率出错，所以应该重复多次来提高准确率，我在这里重复了30次，不过依然有两个测试点过不去。

#### P1018 字符串k模糊匹配

希望改进KMP以得到比暴力匹配更优的算法，但是实际发现如果是模糊匹配，每次移动一格就有可能匹配上，因此类似KMP算法的跳格思想在这里想不通，现在暂时只实现了暴力匹配。

#### P1019 最大流

分别用查找最短增广路径（BFS，Edmonds Karp）和查找最宽增广路径（改版的Dijkstra）两种贪心方法下的Ford Fulkerson算法来计算最大流，Edmonds Karp寻找增广路径的时间复杂度是$O(nm)$，而寻找最宽增广路径的方法是$O(nlogm)$的，所有实际上测试中，发现最短增广路径贪心会导致三个测试点超时，而最宽增广路径则能全部通过。

#### P1020 物资传输

这个题的目标优化函数有分段，并不是线性的，但是可以通过添加辅助变量变成线性的，可以用单纯形法来解，具体操作是对于每一个$y_x$，增加一个辅助变量$t_x$，约束条件为$t_x\geq y_x-c_x$，然后目标函数变成$Minimize\Sigma_{x=1}^n(a_x\times y_x+(b_x-a_x)\times t_x)$，$t_x$的含义是超出转折点的部分，这部分的斜率更大，因此要补上这部分的cost，由于我们要minimize目标函数，所有$t_x$会尽量取小，所有当$y_x\leq c_x$时，$t_x$一定会取0，从而使得优化目标等价于原来的形式。
